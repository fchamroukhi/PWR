%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% A polynomial piecewise regression model for the optimal segmentation of a
time series with regime changes. It uses dynamic programm
%
%
%
% Faicel Chamroukhi Decembre 2008.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear;
clc;
close all



%% toy time series with regime changes
% y =[randn(100,1); 7+randn(120,1);4+randn(200,1); -2+randn(100,1); 3.5+randn(150,1);]';
% n = length(y);
% x = linspace(0,1,n);

load simulated_time_series;

% model specification
K = 5;% number of segments
p = 3; % polynomial degree


pwr = fit_PWR_fisher(x, y, K, p);

fprintf('elapsed time = %g\n', pwr.stats.cputime);
%fprintf('objective value = %f\n',pwr.stats.objective);

show_PWR_results(x, y, pwr);

%% some real time series with regime changes

%load real_time_series_0
%load real_time_series_1
load real_time_series_2

pwr = fit_PWR_fisher(x, y, K, p);

fprintf('elapsed time = %g\n', pwr.stats.cputime);
%fprintf('objective value = %f\n',pwr.stats.objective);
yaxislim = [240, 600];
show_PWR_results(x, y, pwr, yaxislim);



